<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Scope Chain - Javascript Basic &amp; Detail</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body class="light">
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = default_theme; }
            document.body.className = theme;
            document.querySelector('html').className = theme + ' js';
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li><a href="../introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="spacer"></li><li><a href="../Basic/index.html"><strong aria-hidden="true">2.</strong> Basic</a></li><li><ol class="section"><li><a href="../Basic/1-CallStack.html"><strong aria-hidden="true">2.1.</strong> Call Stack</a></li><li><a href="../Basic/2-Type.html"><strong aria-hidden="true">2.2.</strong> Type</a></li><li><a href="../Basic/3-Function.html"><strong aria-hidden="true">2.3.</strong> Function</a></li><li><a href="../Basic/4-Module.html"><strong aria-hidden="true">2.4.</strong> Module</a></li><li><a href="../Basic/5-Event_Loop.html"><strong aria-hidden="true">2.5.</strong> Event Loop</a></li><li><a href="../Basic/6-Async.html"><strong aria-hidden="true">2.6.</strong> Async</a></li><li><a href="../Basic/7-Engine.html"><strong aria-hidden="true">2.7.</strong> Engine</a></li><li><a href="../Basic/8-Bitwise_Operator.html"><strong aria-hidden="true">2.8.</strong> Bitwise Operator</a></li><li><a href="../Basic/9-DOM.html"><strong aria-hidden="true">2.9.</strong> DOM</a></li><li><a href="../Basic/10-Class.html"><strong aria-hidden="true">2.10.</strong> Class</a></li><li><a href="../Basic/11-Call-Apply-Bind.html"><strong aria-hidden="true">2.11.</strong> Call, Apply, Bind</a></li><li><a href="../Basic/12-Prototype.html"><strong aria-hidden="true">2.12.</strong> Prototype</a></li><li><a href="../Basic/13-Object.create_Object.assign.html"><strong aria-hidden="true">2.13.</strong> Object.create, Object.assign</a></li><li><a href="../Basic/index.html"><strong aria-hidden="true">2.14.</strong> To be continue</a></li><li class="spacer"></li></ol></li><li><a href="../ES3/index.html"><strong aria-hidden="true">3.</strong> ES3 in Detail</a></li><li><ol class="section"><li><a href="../ES3/1-Execution_Contexts.html"><strong aria-hidden="true">3.1.</strong> Execution Contexts</a></li><li><a href="../ES3/3-This.html"><strong aria-hidden="true">3.2.</strong> This</a></li><li><a href="../ES3/4-ScopeChain.html" class="active"><strong aria-hidden="true">3.3.</strong> Scope Chain</a></li><li><a href="../ES3/5-Function.html"><strong aria-hidden="true">3.4.</strong> Function</a></li><li><a href="../ES3/6-Closure.html"><strong aria-hidden="true">3.5.</strong> Closure</a></li><li><a href="../ES3/index.html"><strong aria-hidden="true">3.6.</strong> To be continue</a></li></ol></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <style>
  header.warning {
    background-color: rgb(242, 222, 222);
    border-bottom-color: rgb(238, 211, 215);
    border-bottom-left-radius: 4px;
    border-bottom-right-radius: 4px;
    border-bottom-style: solid;
    border-bottom-width: 0.666667px;
    border-image-outset: 0 0 0 0;
    border-image-repeat: stretch stretch;
    border-image-slice: 100% 100% 100% 100%;
    border-image-source: none;
    border-image-width: 1 1 1 1;
    border-left-color: rgb(238, 211, 215);
    border-left-style: solid;
    border-left-width: 0.666667px;
    border-right-color: rgb(238, 211, 215);
    border-right-style: solid;
    border-right-width: 0.666667px;
    border-top-color: rgb(238, 211, 215);
    border-top-left-radius: 4px;
    border-top-right-radius: 4px;
    border-top-style: solid;
    border-top-width: 0.666667px;
    color: rgb(185, 74, 72);
    margin-bottom: 0px;
    margin-left: 0px;
    margin-right: 0px;
    margin-top: 30px;
    padding-bottom: 8px;
    padding-left: 14px;
    padding-right: 35px;
    padding-top: 8px;
    text-align: center;
  }
</style>


                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                                <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                                <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                            </ul>
                            
                            <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                                <i class="fa fa-search"></i>
                            </button>
                            
                        </div>

                        <h1 class="menu-title">Javascript Basic &amp; Detail</h1> 

                        <div class="right-buttons">
                            <a href="../print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                            
                        </div>
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="#es3ecma-262-3-scopechain" id="es3ecma-262-3-scopechain"><h1>[ES3]ECMA-262-3 ScopeChain</h1></a>
<a class="header" href="#소개" id="소개"><h2>소개</h2></a>
<ul>
<li>실행 컨텍스트의 데이터(<strong>변수, 함수 선언 그리고 함수의 매개변수</strong>)는 변수 객체의 프로퍼티( <strong>VO</strong> )로 저장된다.
<ul>
<li>깨알 유용한 정보 : <code>Context = VO|AO + this + SC</code></li>
</ul>
</li>
<li>컨텍스트로 <strong>진입</strong> 할 때 매번 초기값을 갖는 변수 객체를 생성하며(선언 + 초기화)(==호이스팅), 코드 <strong>실행</strong> 할 때 값을 갱신(할당)한다.</li>
</ul>
<p>이번에는 스코프 체인에 대해서 정리를 해보자.
<br/></p>
<a class="header" href="#정의" id="정의"><h2>정의</h2></a>
<p>스코프체인은 대게 중첩 함수와 관련이 있다.</p>
<blockquote>
<p>중첩함수 란 함수안에 함수가 있는 것 &lt;= 당연한 말인 듯하다.</p>
</blockquote>
<p><strong>심지어 부모 함수가 이러한 중첩 함수를 결과 값으로 반환이 가능하다.</strong></p>
<pre><code class="language-js">var x = 10;

function foo() {
 var y = 20;

 function bar() {
   alert(x + y);
 }
 return bar;
}

foo()(); // 30
</code></pre>
<p>소개에서도 나오고 <code>This</code> 편에서도 나왔지만 모든 컨텍스트는 자신의 고유 변수 객체를 가진다.
전역 컨텍스트는 자기 자신을 변수 객체(<code>VO_global</code>)로 가지며, 함수 컨텍스트는 활성화 객체(<code>AO</code>)를 가진다.</p>
<ul>
<li>전역 컨텍스트 = <code>VO + SC + this</code></li>
<li>함수 컨텍스트 = <code>AO + SC + this</code></li>
</ul>
<p>스코프 체인은 내부 컨텍스트가 이용하는 모든(부모) 변수 객체의 <strong>리스트다</strong>.
변수를 검색할 때 이 체인을 이용한다.
<br/></p>
<p>위의 경우에서는 <code>bar</code> 컨텍스트의 스코프 체인은 <code>AO(bar)</code>, <code>AO(foo)</code>, <code>VO(global)</code>를 갖는다.
순서 또한 위와 같이 가진다. 즉 처음에 위치한 것은 자기자신이라는 것이다.
<br/></p>
<blockquote>
<p><code>SC</code> 는 내부 컨텍스트가 이용하는 모든 변수 객체의 리스트</p>
</blockquote>
<p>스코프체인은 실행 컨텍스트와 관련 있으며, <strong>식별자 해석시</strong> 변수 검색에 이용하는 변수 객체의 체인이다.
<br/></p>
<ul>
<li>스코프 체인은 함수를 호출할 때 생성되고</li>
<li>활성화 객체와 함수의 내부 <code>[[scope]]</code> 프로퍼티를 가진다.</li>
</ul>
<p><br/></p>
<a class="header" href="#내부의-모습" id="내부의-모습"><h3>내부의 모습</h3></a>
<pre><code class="language-js">activeExecutionContext = {
   VO: {...}, // or AO
   this: thisValue,
   Scope: [ // 스코프 체인(scope chain)
     // 식별자 검색에 이용할 모든 변수 객체의 리스트
   ]
};
</code></pre>
<p><strong>스코프의 정의</strong></p>
<pre><code class="language-js">Scope = AO + [[scope]]
</code></pre>
<p>예를 들기 위해서 스코프와 <code>[[Scope]]</code> 를 <code>ECMAScript</code> 의 일반 배열로 나타낼 수 있다.</p>
<pre><code class="language-js">var Scope = [VO1, VO2, ..., VOn]; // 스코프 체인
</code></pre>
<pre><code class="language-js">var VO1 = {__parent__: null, ... other data};
var VO2 = {__parent__: VO1, ... other data};
...
</code></pre>
<a class="header" href="#함수-라이프-사이클function-life-cycle" id="함수-라이프-사이클function-life-cycle"><h2>함수 라이프 사이클(Function life cycle)</h2></a>
<p>함수의 라이프 사이클은 <strong>생성 단계</strong>, <strong>활성화 단계(call)</strong> 의 2가지로 나뉜다.</p>
<a class="header" href="#함수-생성" id="함수-생성"><h3>함수 생성</h3></a>
<p>모두가 아시다시피 컨텍스트 단계로 들어갈 때 <strong>변수/활성화 객체(VO/AO)가 함수 선언으로 들어간다.</strong></p>
<pre><code class="language-js">var x = 10;

function foo() {
  var y = 20;
  alert(x + y);
}

foo(); // 30
</code></pre>
<p>함수가 활성화가 되면 함수는 <code>30</code> 을 출력한다.
<br/></p>
<p>여기에서 변수 <code>y</code> 는 함수 <code>foo</code> 에서 정의되어있지만, 변수 <code>x</code> 는 <code>foo</code> 의 컨텍스트에 정의되어 있지않다. 그러므로 <code>foo</code> 의 <code>AO</code> 에 추가가 되지 않는다. 그렇다면 <code>x</code> 는 <code>foo</code> 에 존재하지 않는 것인가?
<br/></p>
<pre><code class="language-js">fooContext.AO = {
  y: undefined // undefined – 컨텍스트 접근시, 20 – 활성화시
};
</code></pre>
<p><code>foo</code> 컨텍스트의 활성화 객체는 <code>y</code> 프로퍼티 만을 가진다.
그렇다면 어떻게 해서 함수 <code>foo</code> 가 변수 <code>x</code> 에 접근할 수 있을까?
<br/></p>
<p><code>[[Scope]]</code> 는 현재 함수 컨텍스트의 상위에 있는 <strong>모든 부모 변수 객체의 계층 체인</strong> 이다. 이 체인은 <strong>함수가 생성될 때 함수에 저장</strong>된다.
<br/></p>
<p>함수를 생성할 때 <code>[[Scope]]</code> 프로퍼티가 함수에 저장되는데, 일단 한 번 저장되고 나면 함수가 사라질 때까지 <strong>정적으로 변하지 않는다</strong> 는 사실을 주목하자. 함수를 결코 <strong>호출할 수 없어도</strong>, 함수 객체는 이미 <code>[[Scope]]</code> 프로퍼티를 가지고 있다.
<br/></p>
<pre><code class="language-js">foo.[[Scope]] = [
  globalContext.VO // === Global
];
</code></pre>
<a class="header" href="#함수-활성화" id="함수-활성화"><h2>함수 활성화</h2></a>
<p>컨텍스트로 진입하고 <code>AO/VO</code> 가 만들어진 후에, 컨텍스트의 <code>scope</code> 프로퍼티는 다음과 같이 정의된다.</p>
<pre><code class="language-js">Scope = AO|VO + [[Scope]]
</code></pre>
<p>여기서 중요한 것은 활성화 객체가 <code>Scope</code> 배열의 첫번째 원소로 제일 앞으로 온다는 것이다.</p>
<pre><code class="language-js">Scope = [AO].concat([[Scope]]);
</code></pre>
<p>식별자 해석은 변수(또는 함수 선언)가 스코프 체인의 어떤 변수 객체에 속하는지를 결정하는 과정이다.
<br/></p>
<p>식별자 해석 과정은 변수의 이름에 해당하는 프로퍼티를 검색하는 과정을 포함하며, 스코프 체인 가장 깊은 곳에 있는 컨텍스트의 변수 객체부터 시작해서 가장 위에 있는 변수 객체까지 연속적으로 검사하는 과정이다.
<br/></p>
<p>그 결과 <strong>현재 컨텍스트의 지역 변수는 부모 컨텍스트에 있는 변수보다 검색 우선 순위를 가지며</strong>, 이름이 같지만 서로 다른 컨텍스트에 존재하는 두 변수의 경우, <strong>더 깊은 컨텍스트에 있는 변수가 우선</strong>한다. 즉 가까운 곳에 위치한 변수가 우선순위가 높다는 것이다.
<br/></p>
<pre><code class="language-js">var x = 10;

function foo() {
 var y = 20;

 function bar() {
   var z = 30;
   alert(x +  y + z);
 }

 bar();
}

foo(); // 60
</code></pre>
<p>전역 컨텍스트의 변수 객체 :</p>
<pre><code class="language-js">globalContext.VO === Global = {
 x: 10
 foo: &lt;reference to function&gt;
};
</code></pre>
<p><code>foo</code> 생성 시점에 <code>foo</code> 의 <code>[[Scope]]</code> 프로퍼티 :</p>
<pre><code class="language-js">foo.[[Scope]] = [
 globalContext.VO
];
</code></pre>
<p><code>foo</code> 함수의 활성화 시점(컨텍스트로 진입하는 단계)에 <code>foo</code> 컨텍스트의 활성화 객체 :</p>
<pre><code class="language-js">fooContext.AO = {
 y: 20,
 bar: &lt;reference to function&gt;
};
</code></pre>
<p><code>foo</code> 컨텍스트의 스코프 체인 :</p>
<pre><code class="language-js">fooContext.Scope = fooContext.AO + foo.[[Scope]] 

fooContext.Scope = [
  fooContext.AO,
  globalContext.VO
];
</code></pre>
<p>중첩된 <code>bar</code> 함수가 생성되는 시점에 <code>bar</code> 함수의 <code>[[Scope]]</code> :</p>
<pre><code class="language-js">bar.[[Scope]] = [
  fooContext.AO,
  globalContext.VO
];
</code></pre>
<p><code>bar</code> 활성화 시점에 <code>bar</code> 컨텍스트의 활성화 객체 :</p>
<pre><code class="language-js">barContext.AO = {
  z: 30
};
</code></pre>
<p><code>bar</code> 컨텍스트의 스코프 체인 :</p>
<pre><code class="language-js">barContext.Scope = barContext.AO + bar.[[Scope]] // i.e.:

barContext.Scope = [
  barContext.AO,
  fooContext.AO,
  globalContext.VO
];
</code></pre>
<a class="header" href="#스코프의-특징scope-features" id="스코프의-특징scope-features"><h2>스코프의 특징(Scope features)</h2></a>
<a class="header" href="#클로저" id="클로저"><h2>클로저</h2></a>
<p><code>ECMAScript</code> 의 클로저는 <code>[[Scope]]</code> 프로퍼티와 직접적으로 관련이 있다. <code>[[Scope]]</code> 는 함수를 생성할 때 함수에 저장되어서, 함수 객체가 사라질 때까지 존재한다. 실제로, 클로저는 정확하게 함수 코드와 <code>[[Scope]]</code> 프로퍼티의 조합이다</p>
<pre><code class="language-js">var x = 10;

function foo() {
    alert(x);
}

(function () {
    var x = 20;
    foo(); // 10, but not 20
})();
</code></pre>
<p>변수 <code>x</code>는 foo 함수의 <code>[[Scope]]</code> 에 있는 것을 알 수 있다. 변수를 검색할 때, 함수 호출 시점의 동적인 체인(이 경우 변수 <code>x</code>의 값은 20이 될 것이다)이 아닌, 함수 생성 순간에 정의된 어휘적인 체인을 이용하였다.</p>
<pre><code class="language-js">function foo() {
  var x = 10;
  var y = 20;

  return function () {
    alert([x, y]);
  };
}

var x = 30;
var bar = foo(); // 익명 함수를 반환한다.

bar(); // [10, 20]
</code></pre>
<p>위이 예제에서도 역시 식별자 해석에 함수 생성 시점에 정의된 어휘적 스코프 체인을 이용하였다. 변수 <code>x</code>를 30이 아닌 10으로 해석했다. 게다가, 이 예제는 함수의 <code>[[Scope]]</code> (함수 <code>foo</code>가 반환한 익명 함수의 경우에)가 심지어 생성된 함수의 컨텍스트가 이미 종료되고 난 이후에도 존재하고 있음을 명확하게 보여준다.
<br/></p>
<a class="header" href="#function-생성자로-생성한-함수의-scope" id="function-생성자로-생성한-함수의-scope"><h3>Function 생성자로 생성한 함수의 <code>[[Scope]]</code></h3></a>
<p>위의 예제에서 함수 생성시에 [[Scope]] 프로퍼티를 가져오고 이 프로퍼티를 통해서 모든 부모 컨텍스트의 변수에 접근한다는 것을 보았다. 그러나, 이 규칙에는 한가지 중요한 예외가 있는데, Function 생성자를 이용해서 함수를 생성하는 경우는 다르다</p>
<pre><code class="language-js">var x = 10;

function foo() {
  var y = 20;

  function barFD() { // FunctionDeclaration
    alert(x);
    alert(y);
  }

  var barFE = function () { // FunctionExpression
    alert(x);
    alert(y);
  };

  var barFn = Function('alert(x); alert(y);');
  barFD(); // 10, 20
  barFE(); // 10, 20
  barFn(); // 10, &quot;y&quot; is not defined
}

foo();
</code></pre>
<p>위에 보이듯이 생성자로 만든 함수는 <code>Scope</code>가 다르다. 그러나 <code>y</code> 에는 접근을 한다 이것은 <code>[[Scope]]</code> 로 <code>global</code>은 가진다는 것이다.</p>
<a class="header" href="#2차원-스코프-체인-검색" id="2차원-스코프-체인-검색"><h3>2차원 스코프 체인 검색</h3></a>
<p>스코프 체인 검색의 중요한 포인트는 <code>ECMAScript</code> 의 프로토타입적인 성격 때문에 변수 객체의 프토토타입 또한 고려해야 한다는 점이다. 객체 내에서 직접적으로 프로퍼티를 찾지 못한다면, <strong>프로토타입 체인까지 검색을 수행</strong> 한다. 즉, 일종의 2차원 체인 검색인 셈이다. <strong>(1) 스코프 체인 연결, (2) 그리고 깊은 프로토타입 체인 연결에 있는 모든 스코프 체인 연결을 검색</strong> 한다.</p>
<pre><code class="language-js">function foo() {
  alert(x);
}

Object.prototype.x = 10;
foo(); // 10
</code></pre>
<p>쉽게 말하면 역시 <code>scope</code> 를 검색했는데 없다 그러면 <code>protptype chain</code> 까지 검색을 한다는 것이다. 그래서 2차원이다.
<br/></p>
<a class="header" href="#전역-컨텍스트와-eval-컨텍스트의-스코프-체인" id="전역-컨텍스트와-eval-컨텍스트의-스코프-체인"><h3>전역 컨텍스트와 <code>eval</code> 컨텍스트의 스코프 체인</h3></a>
<p>전역 컨텍스트의 스코프 체인은 오직 전역 객체만을 갖는다. 그리고 <code>eval</code> 코드의 컨텍스트는 호출 컨텍스트와 같은 스코프 체인을 갖는다.</p>
<p><strong>무조건 글로벌이라고 생각하면 된다.</strong></p>
<pre><code class="language-js">globalContext.Scope = [
    Global
];
evalContext.Scope === callingContext.Scope;
</code></pre>
<p><br/></p>
<a class="header" href="#코드-실행-중-스코프-체인에-영향을-미치기" id="코드-실행-중-스코프-체인에-영향을-미치기"><h3>코드 실행 중 스코프 체인에 영향을 미치기</h3></a>
<p><code>ECMAScript</code> 에는 코드 실행 런타임에 스코프 체인을 변경할 수 있는 두 가지 구문이 있다.
<br/></p>
<p><code>with</code>문과 <code>catch</code>절이다.
<br/></p>
<p>둘 다 이들 구문 내에 나타나는 식별자를 찾기 위한 객체를 <strong>스코프 체인의 가장 앞에 추가한다.</strong> 이 중에 하나를 코드에 적용하면, 스코프 체인은 아래와 같이 변경된다.</p>
<pre><code class="language-js">Scope = withObject|catchObject + AO|VO + [[Scope]]
</code></pre>
<p><code>with</code> 문의 경우에는 파라미터로 넘겨 받은 객체를 추가한다(그 결과, 이 객체의 프로퍼티에 접두사를 붙이지 않고 접근할 수 있다)</p>
<pre><code class="language-js">var foo = {x: 10, y: 20};

with (foo) {
  alert(x); // 10
  alert(y); // 20
}
</code></pre>
<pre><code class="language-js">Scope = foo + AO|VO + [[Scope]]
</code></pre>
<pre><code class="language-js">var x = 10, y = 10;

with ({x: 20}) {
  var x = 30, y = 30;

  alert(x); // 30
  alert(y); // 30
}

alert(x); // 10
alert(y); // 30
</code></pre>
<p><strong>중요</strong></p>
<ol>
<li><code>x = 10, y = 10</code></li>
<li>객체 { <code>x : 20</code> }을 스코프 체인의 앞에 추가한다.</li>
<li>컨텍스트 진입 단계에서 모든 변수를 해석하고 추가했기 때문에 <code>with</code> 내에서 <code>var</code> 구문을 만났을 때 아무 것도 만들지 않는다.</li>
<li>오직 <code>x</code> 의 값을 수정하는데, 정확하게는 두번째 단계에서 스코프 체인의 앞에 추가된 객체 내에서 해석되는 <code>x</code>를 말한다. 20이었던 <code>x</code> 의 값이 10이 된다.</li>
<li>또한 위의 변수 객체 내에서 해석되는 <code>y</code>도 변경한다. 결과적으로 10이었던 <code>y</code>의 값이 30이 된다.</li>
<li>다음으로 <code>with</code> 문이 종료된 후에, 스페셜 객체는 스코프 체인에서 제거된다( <code>x</code> 의 값이 변경되고, 30 또한 객체에서 제거된다). 즉, 스코프 체인 구조가 <code>with</code> 문에 의해서 확장되기 이전 상태로 돌아온다.</li>
<li>마지막에 있는 두 번의 <code>alert</code> 호출을 통해서 알 수 있듯이, 현재 변수 객체 내에 있는 <code>x</code>의 값은 같은 상태로 남아있고, <code>y</code>의 값은 <code>with</code> 문 내에서 변경한 상태 그대로 30이다.</li>
</ol>
<p><code>catch</code> 절 또한 <code>exception</code> 파라미터에 접근하기 위해서 <code>exception</code> 파라미터의 이름을 유일한 프로퍼티로 갖는 중간 스코프 객체를 만들며, 이 객체를 스코프 체인의 앞에 추가한다. 개략적으로 아래와 같이 나타낼 수 있다.</p>
<pre><code class="language-js">try {
  ...
} catch (ex) {
  alert(ex);
}
</code></pre>
<pre><code class="language-js">var catchObject = {
  ex: &lt;exception object&gt;
}
Scope = catchObject + AO|VO + [[Scope]]
</code></pre>
<p><code>catch</code>절 내의 작업이 종료된 후에, 스코프 체인은 이전 상태로 돌아온다.</p>
<hr />
<a class="header" href="#reference" id="reference"><h4>Reference</h4></a>
<ul>
<li><a href="http://dmitrysoshnikov.com/ecmascript/chapter-4-scope-chain/">scope-chain</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../ES3/3-This.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../ES3/5-Function.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="../ES3/3-This.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="../ES3/5-Function.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
